jQuery(document).ready(function(e){"use strict";e("#feedback").hide(),e("#processing").hide(),e("#response").hide(),e(".navbar-toggle").click(function(){e(this).toggleClass("open"),e(".side-collapse").toggleClass("show")});var t=e("[data-toggle=collapse-side]"),o=t.attr("data-target"),i=t.attr("data-target-2");t.click(function(){e(o).toggleClass("in"),e(i).toggleClass("out")}),e("body").on("click",".datepicker",function(){e(this).datepicker({showButtonPanel:!0,dateFormat:"mm/dd/yy",changeMonth:!0,changeYear:!0,showAnim:"slideDown"}),e(this).datepicker("show")}),e("input[list]").length>0&&document.querySelector("input[list]").addEventListener("input",function(t){var o=t.target,i=o.getAttribute("list"),a=document.querySelectorAll("#"+i+" option"),n=document.getElementById(o.id+"-hidden"),s=o.value;n.value=s;for(var r=0;r<a.length;r++){var u=a[r];if(1==u.getAttribute("data-onetime")?e(".oneTime .oneTimeCheck").prop("checked",!0):e(".oneTime .oneTimeCheck").prop("checked",!1),u.innerText===s){n.value=u.getAttribute("data-value");break}e(".oneTime .oneTimeCheck").prop("checked",!1)}}),e(function(){e('[data-toggle="tooltip"]').tooltip()}),e("body").on("click",".postLink",function(){var t=e(this).attr("href"),o=e(this).data("keys").split(","),i=e(this).data("values").split(","),a={};return e.each(o,function(e,t){a[o[e]]=i[e]}),e.redirect(t,a),!1}),e("body").on("click",".showPW",function(){var t=e(this).data("pw-field");"password"===e(t).attr("type")?e(t).attr("type","text"):e(t).attr("type","password")}),e("body").on("blur",".input-username",function(){var t="username="+e(this).val();return e.ajax({type:"POST",url:"/ajax/admin/checkUsername.php",data:t}).done(function(t){t.output.usernameExists>0?e(".unExist").html(t.output.feedback):e(".unExist").html("")}).fail(function(){e("#response").html("POST FAILED")}),!1}),e("#registerForm").validate({rules:{password:"required",password_repeat:{equalTo:"#password"}},submitHandler:function(t){var o=e(t).serialize();return e.ajax({type:"POST",url:"/ajax/admin/register.php",data:o}).done(function(t){e("#feedback").show(),e("#processing").show(),t.output.accountCreated?(e("#processing").hide(),e("#response").show().html(t.output.feedback),"true"==t.output.accountCreated?(t.output.redirect&&window.location.replace(t.output.redirect),t.output.updateString&&(e("#searchTable").append(t.output.updateString),e("#registerForm").trigger("reset"),e("#addUser").removeClass("show"))):console.log("FAILURE"),setTimeout(function(){e("#feedback").fadeOut()},2e3)):console.log("NO ACCOUNT")}).fail(function(){console.log("FAILURE 3")}),!1}}),e("body").on("click","#btnRegister",function(){e("#forgot").removeClass("show")}),e("#forgotForm").validate({rules:{usernameForgot:{required:function(t){return e("#emailForgot").is(":blank")}},emailForgot:{required:function(t){return e("#usernameForgot").is(":blank")}}},submitHandler:function(t){var o=e(t).serialize();return e.ajax({type:"POST",url:"/ajax/admin/password.php",data:o}).done(function(t){e("#feedback").show(),e("#processing").show(),t.output.feedback?(e("#processing").hide(),e("#response").show().html(t.output.feedback),t.output.redirect?window.location.replace(t.output.redirect):console.log("FAILURE"),setTimeout(function(){e("#feedback").fadeOut()},3e3)):console.log("NO ACCOUNT")}).fail(function(){console.log("FAILURE 3")}),!1}}),e("body").on("click","#btnForgot",function(){e("#register").removeClass("show")}),e("#resetForm").validate({rules:{password:"required",password_repeat:{equalTo:"#password"}},submitHandler:function(t){var o=e(t).serialize();return e.ajax({type:"POST",url:"/ajax/admin/password.php",data:o}).done(function(t){e("#feedback").show(),e("#processing").show(),t.output.feedback?(e("#processing").hide(),e("#response").show().html(t.output.feedback),t.output.redirect?window.location.replace(t.output.redirect):console.log("FAILURE"),setTimeout(function(){e("#feedback").fadeOut()},3e3)):console.log("NO ACCOUNT")}).fail(function(){console.log("FAILURE 3")}),!1}});var a="",n="";e(".require-one")[0]&&(a=e(".require-one"),n=e.map(a,function(t,o){return e(t).attr("name")}).join(" ")),e.validator.addMethod("require-one",function(t){return e(".require-one:checked").size()>0},"Please check at least one"),e.validator.setDefaults({debug:!0,groups:{checks:n},rules:{password_repeat:{equalTo:"#password"}},errorPlacement:function(e,t){"checkbox"==t.attr("type")?e.insertAfter(".checkbox-group"):"radio"==t.attr("type")?e.insertAfter(t.closest(".activity-signup-buttons")):e.insertAfter(t)},success:"valid"});var s=e(".adminForm");s.validate(),e("body").on("click",".adminForm .adminBtn",function(){if(s.valid()){e("#feedback").show(),e("#processing").show();var t=e(this).data("op"),o=e(this).closest(".adminForm"),i="/ajax/admin/"+t+".php",a="op="+t+"&"+e(o).serialize();return e.ajax({type:"POST",url:i,data:a}).done(function(t){if(t.output.op){if("update"==t.output.op)e("#processing").hide(),e("#response").show().html(t.output.feedback),t.output.redirect?setTimeout(function(){e("#feedback").hide(),window.location.replace(t.output.redirect)},2e3):setTimeout(function(){e("#feedback").fadeOut()},2e3);else if("add"==t.output.op)e("#list-group-edit").append(t.output.updateString),e("#processing").hide(),e("#response").show().html(t.output.feedback),e(".add-form").trigger("reset"),e(".collapse-form").removeClass("show"),t.output.redirect?setTimeout(function(){window.location.replace(t.output.redirect)},2e3):setTimeout(function(){e("#feedback").fadeOut()},2e3);else if("delete"==t.output.op){e("#processing").hide(),e("#response").show().html(t.output.feedback);var o="#form-"+t.output.update;t.output.redirect?setTimeout(function(){window.location.replace(t.output.redirect)},2e3):e.when(e(o).animate({backgroundColor:"#fbc7c7"},"fast").animate({opacity:"hide"},"slow")).then(function(){e(o).remove(),e("#feedback").fadeOut()})}}else e("#response").html("No Output")}).fail(function(){e("#response").html("POST FAILED")}),!1}}),e("body").on("click",".printLink",function(){e("#feedback").show(),e("#processing").show();var t=e(this).data("camper")?e(this).data("camper"):"",o=e(this).data("bunk")?e(this).data("bunk"):"",i="camper="+t+"&week="+(e(this).data("week")?e(this).data("week"):"")+"&bunk="+o+"&activity="+(e(this).data("activity")?e(this).data("activity"):"")+"&date="+(e(this).data("date")?e(this).data("date"):"");return e.ajax({type:"POST",url:"/ajax/report/print-schedule.php",data:i}).done(function(t){if(t.output){var o=window.open("","",""),i=!1;return navigator.userAgent.toLowerCase().indexOf("chrome")>-1&&(i=!0),o.document.write('<!doctype html><html><head><meta charset="utf-8">'),o.document.write(t.output.header),o.document.write("</head><body>"),i&&o.document.write('<div class="container"><div class="text-right"><a class="btn btn-primary btn-print" onclick="printPage()">Print Page</a></div></div>'),o.document.write(t.output.body),i&&o.document.write("<script>function printPage() { window.print(); window.close(); }<\/script>"),o.document.write("</body></html>"),o.document.close(),o.focus(),i||(o.print(),o.close()),e("#feedback").hide(),e("#processing").hide(),!0}e("#response").html("No Output")}).fail(function(){e("#response").html("POST FAILED")}),!1}),e("body").on("click","form.scheduleForm .activity-signup-buttons .schedule-button",function(){var t=e("form.scheduleForm"),o=e(this).parent(".schedule-item");if(e(this).parents(".activity-signup-buttons").children(".schedule-item").not(o).each(function(){e(this).children(".schedule-button").removeClass("active"),e(this).children(".schedule-radio").removeClass("active"),e(this).children(".schedule-radio").removeAttr("checked")}),e(this).data("onetime")){var i="."+e(this).data("onetime");e(i).not(o).each(function(){e(this).addClass("disabled"),e(this).children(".schedule-radio").prop("checked",!1),e(this).children(".schedule-radio").prop("disabled",!0),e(this).children(".schedule-button").addClass("disabled")})}else{var a=e(this).closest(".activity-signup-buttons"),n=new Array;0!==e(a).find(".onetime").length&&(e(a).find(".onetime .schedule-button").each(function(){var t=e(this).data("onetime");e(this).prop("checked",!1),-1===e.inArray(t,n)&&"yes"!==e(this).data("previous")&&n.push(t)}),0!==n.length?(n=function(e){var t=-1,o=e?e.length:0,i=-1,a=[];for(;++t<o;){var n=e[t];n&&(a[++i]=n)}return a}(n),e.each(n,function(o,i){var a="."+i,n=0;e(t).find(a+" .schedule-radio").each(function(){e(this).prop("checked")&&(n+=1)}),0===n&&(e(a).removeClass("disabled"),e(a).children(".schedule-button").removeClass("disabled"))})):console.log("array is empty"))}}),e("body").on("change","form.activity-admin .period-select",function(){var t="period="+e(this).children("option:selected").val();e.ajax({type:"POST",url:"/ajax/admin/comparePeriodGroup.php",data:t}).done(function(t){if(t.output.groups){var o=t.output.groups.split(",");e("form.activity-admin .group-select").val(o)}t.output.days&&e.each(t.output.days,function(t,o){0===parseInt(o)?(e("form.activity-admin ."+t+" input").attr("disabled",!0),e("form.activity-admin ."+t+" input").prop("checked",!1),e("form.activity-admin ."+t).addClass("text-muted")):(e("form.activity-admin ."+t+" input").attr("disabled",!1),e("form.activity-admin ."+t).removeClass("text-muted"))})}).fail(function(){console.log("fail")})});var r=e(".scheduleForm");r.validate(),e("body").on("click",".scheduleForm .scheduleBtn",function(){if(r.valid()){e("#feedback").show(),e("#processing").show();var t=e(this).data("op"),o=e(this).closest(".scheduleForm"),i="/ajax/schedule/"+t+".php",a="op="+t+"&"+e(o).serialize();return e.ajax({type:"POST",url:i,data:a}).done(function(t){t.output.op?"update"==t.output.op?(e("#processing").hide(),e("#response").show().html(t.output.feedback),t.output.redirect?setTimeout(function(){e("#feedback").hide(),window.location.replace(t.output.redirect)},2e3):setTimeout(function(){e("#feedback").fadeOut()},2e3)):"add"==t.output.op&&(e("#processing").hide(),e("#response").show().html(t.output.feedback),t.output.redirect?setTimeout(function(){window.location.replace(t.output.redirect)},2e3):setTimeout(function(){e("#feedback").fadeOut()},2e3)):e("#response").html("No Output")}).fail(function(){e("#response").html("POST FAILED")}),!1}}),e("body").on("click",".submitLink",function(){return e(this).parent("form").submit(),!1}),e("body").on("click",".scroll-link",function(t){var o=e(this).attr("href");e("html,body").stop().animate({scrollTop:e(o).offset().top-50},1250,"easeInOutExpo"),t.preventDefault()}),e(".table-data-table").DataTable(),e(".dataTables_length").addClass("bs-select"),e("body").on("click",".btn-clear",function(){confirm("Are you sure you want to delete this schedule?")&&function(t){e("#feedback").show(),e("#processing").show();var o=e(t).data("op"),i=e(t).data("user"),a=e(t).data("week"),n=e(t).data("activity"),s="/ajax/schedule/"+o+".php",r="user="+i+"&week="+a+"&activity="+n;e.ajax({type:"POST",url:s,data:r}).done(function(t){t.output.op?(e("#processing").hide(),e("#response").show().html(t.output.feedback),"success"==t.output.result?setTimeout(function(){e("#feedback").fadeOut(),t.output.info?(t.output.info.activity?e("#activity-signups").find("td").each(function(){e(this).html('<p class="text-muted"><em>No Signups Yet</em></p>')}):t.output.info.week&&e("#week-"+t.output.info.week).find(".period").each(function(){e(this).children("form").removeClass("scheduled-activity"),e(this).find("input.event").removeClass("btn-block btn-light-green d-block").addClass("btn-light").val("Click to Schedule Activities")}),setTimeout(function(){e("#feedback").fadeOut()},2e3)):window.location.reload()},2e3):setTimeout(function(){e("#feedback").fadeOut()},2e3)):e("#response").html("No Output")}).fail(function(){e("#response").html("POST FAILED")})}(this)})});